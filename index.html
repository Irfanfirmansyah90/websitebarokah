<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Website RT - Data Warga & Iuran</title>
</head>
<body>
  <h1>Website RT - Data Warga & Iuran</h1>

  <!-- Form Input Data Warga -->
  <h2>Tambah Data Warga</h2>
  <form id="formWarga">
    <input type="text" id="nama" placeholder="Nama" required><br><br>
    <input type="text" id="pekerjaan" placeholder="Pekerjaan"><br><br>
    <input type="text" id="perkawinan" placeholder="Status Perkawinan"><br><br>
    <input type="text" id="sekolah" placeholder="Status Sekolah"><br><br>
    <button type="submit">Simpan Warga</button>
  </form>

  <!-- List Data Warga -->
  <h3>Data Warga</h3>
  <ul id="listWarga"></ul>

  <hr>

  <!-- Form Input Keuangan -->
  <h2>Catat Iuran</h2>
  <form id="formIuran">
    <input type="text" id="wargaNama" placeholder="Nama Warga" required><br><br>
    <input type="number" id="jumlah" placeholder="Jumlah Iuran (Rp)" required><br><br>
    <button type="submit">Simpan Iuran</button>
  </form>

  <!-- List Data Keuangan -->
  <h3>Data Iuran</h3>
  <ul id="listIuran"></ul>

  <!-- Firebase SDK -->
  <script type="module">
    // Import Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Konfigurasi Firebase (punya Anda)
    const firebaseConfig = {
      apiKey: "AIzaSyC6s1V-g8KHNpJIjlSVTP7Twz4YLcjQtzY",
      authDomain: "database-barokah.firebaseapp.com",
      projectId: "database-barokah",
      storageBucket: "database-barokah.firebasestorage.app",
      messagingSenderId: "135687399675",
      appId: "1:135687399675:web:92bf5672e9b533e401285e"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Tambah data warga
    document.getElementById("formWarga").addEventListener("submit", async (e) => {
      e.preventDefault();
      let nama = document.getElementById("nama").value;
      let pekerjaan = document.getElementById("pekerjaan").value;
      let perkawinan = document.getElementById("perkawinan").value;
      let sekolah = document.getElementById("sekolah").value;

      await addDoc(collection(db, "warga"), {
        nama, pekerjaan, perkawinan, sekolah
      });

      alert("Data warga berhasil disimpan!");
      document.getElementById("formWarga").reset();
      loadWarga();
    });

    // Tambah data iuran
    document.getElementById("formIuran").addEventListener("submit", async (e) => {
      e.preventDefault();
      let wargaNama = document.getElementById("wargaNama").value;
      let jumlah = document.getElementById("jumlah").value;

      await addDoc(collection(db, "keuangan"), {
        nama: wargaNama,
        jumlah: parseInt(jumlah)
      });

      alert("Data iuran berhasil disimpan!");
      document.getElementById("formIuran").reset();
      loadIuran();
    });

    // Load data warga
    async function loadWarga() {
      const list = document.getElementById("listWarga");
      list.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "warga"));
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        let li = document.createElement("li");
        li.textContent = `${data.nama} | ${data.pekerjaan} | ${data.perkawinan} | ${data.sekolah}`;
        list.appendChild(li);
      });
    }

    // Load data iuran
    async function loadIuran() {
      const list = document.getElementById("listIuran");
      list.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "keuangan"));
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        let li = document.createElement("li");
        li.textContent = `${data.nama} - Rp ${data.jumlah}`;
        list.appendChild(li);
      });
    }

    // Panggil saat halaman dibuka
    loadWarga();
    loadIuran();
  </script>
</body>
</html>
